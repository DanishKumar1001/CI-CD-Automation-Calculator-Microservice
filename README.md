# üßÆ Calculator Microservice ‚Äì Database Integration & Kubernetes Deployment
This project demonstrates the deployment of a Dockerized Node.js calculator microservice onto a Kubernetes cluster as part of SIT737 Task 9.1P. It includes Kubernetes port-forward setup, browser access, application update with a new endpoint, Docker image versioning, and redeployment on Kubernetes.

# üöÄ Technologies Used

- Node.js
- Express.js
- MongoDB (Atlas)
- Docker
- Docker Compose
- Kubernetes

# ‚öôÔ∏è Setup and Deployment Instructions

### 1. Clone the Repository

git clone https://github.com/DanishKumar1001/sit737-2025-t1-prac7p
cd SIT737-2025-t1-prac7c

## 1. Build and Push Docker Image

docker build -t calculator .
docker tag calculator your-dockerhub-username/calculator :latest
docker push your-dockerhub-username/calculator :latest

## 2. Deploy Application to Kubernetes

### Apply the Deployment:

kubectl apply -f deployment.yaml

### Apply the Service:

kubectl apply -f service.yaml

### Check status:

kubectl get deployments
kubectl get pods
kubectl get services

## 3. Access the Application

After deploying, access the application using:

http://localhost:<NodePort>/

## 4. Port-Forward to Access Locally

kubectl port-forward service/calculator-microservice 3000:80

## 5. Test API Endpoints

### 1. Addition

GET /add?num1=10&num2=5

### 2. Subtraction

GET /subtract?num1=10&num2=5
Returns error if num1 < num2.

### 3. Multiplication

GET /multiply?num1=10&num2=5

### 4. Division

GET /divide?num1=10&num2=5
Returns error if num2 == 0.

### 5. Exponentiation(Power)

GET /power?num1=2&num2=3

### 6. Modulo 

GET /modulo?num1=10&num2=3
Returns error if num2 == 0.

### 7. Square Root:

GET /sqrt?num1=16
Returns error if num1 is negative.

### 8. Percentage Calculator

GET /percentage?num1=50&num2=200

‚úÖ You can test using a browser, curl, or Postman.

## 5. CRUD ENDPOINTS

| Method | Endpoint          | Description               |
| ------ | ----------------- | ------------------------- |
| GET    | `/operations`     | Retrieve all operations   |
| GET    | `/operations/:id` | Retrieve by ID            |
| POST   | `/operations`     | Create a new record       |
| PUT    | `/operations/:id` | Update an existing record |
| DELETE | `/operations/:id` | Delete a single record    |
| DELETE | `/operations`     | Delete all records        |


## 6. Error Testing

**Missing Parameters:** Returns 400 Bad Request
**Invalid Numbers:** Returns 400 Bad Request
**Subtraction Edge Case:** num1 must be greater than num2
**Division by Zero:** Not allowed
**Modulo by Zero:** Not allowed
**Square Root of Negative Number:** Not allowed
**Invalid Endpoint:** Returns 404 Not Found
**Zero Denominator for percentage:** Returns 400 Bad Request if num2 == 0.

# üì¶ Files Description

| File / Folder             | Description                                                                |
| ------------------------- | -------------------------------------------------------------------------- |
| `calculator.js`           | Main Node.js Express microservice handling arithmetic operations and CRUD. |
| `Dockerfile`              | Instructions to build the Docker image for the microservice.               |
| `docker-compose.yml`      | (Optional) Docker setup for local multi-container testing with MongoDB.    |
| `deployment.yaml`         | Kubernetes Deployment config for the calculator microservice.              |
| `service.yaml`            | Kubernetes Service exposing the calculator microservice (NodePort).        |
| `mongodb-deployment.yaml` | Kubernetes Deployment config for MongoDB (optional if using Atlas).        |
| `mongo-service.yaml`      | Kubernetes Service for MongoDB access within the cluster.                  |
| `mongo-pv.yaml`           | Persistent Volume definition for MongoDB storage (optional).               |
| `mongo-pvc.yaml`          | Persistent Volume Claim to bind MongoDB to the PV (optional).              |
| `logs/`                   | Folder that stores logs generated by Winston (info and error logs).        |
| `dump/`                   | Folder for optional MongoDB backup using `mongodump`.                      |
| `package.json`            | Lists project metadata, scripts, and dependencies.                         |
| `package-lock.json`       | Locks dependency versions to ensure consistent installs.                   |
| `README.md`               | Complete documentation and usage instructions for the project.             |

## üîê Security Notes

MongoDB credentials stored securely in Kubernetes secrets.
Database access restricted via MongoDB Atlas IP whitelist.

## üõ°Ô∏è Backup & Recovery

For automated backups, upgrade from Free Tier to M10 or Flex on MongoDB Atlas.
Manual backups possible using MongoDB Compass or mongodump.

#  Reference Links:

Docker - https://docs.docker.com/
Kubernetes - https://kubernetes.io/docs/home/
Mongo Atlas - https://www.mongodb.com/products/platform/atlas-database